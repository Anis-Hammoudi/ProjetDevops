# -*- mode: ruby -*-
# vi: set ft=ruby :
# =============================================================================
# VAGRANTFILE - Création des VMs pour Docker Swarm
# =============================================================================
# Ce fichier est orchestré par Terraform (main.tf)
# La configuration est gérée par Ansible (exécuté depuis WSL)
# =============================================================================

MANAGER_IP = "192.168.56.10"
WORKER1_IP = "192.168.56.11"  
WORKER2_IP = "192.168.56.12"

Vagrant.configure("2") do |config|
  config.vm.box = "ubuntu/jammy64"
  config.vm.box_check_update = false

  # Configuration VirtualBox commune
  config.vm.provider "virtualbox" do |vb|
    vb.memory = 1024
    vb.cpus = 1
    vb.linked_clone = true
  end

  # Configuration SSH commune pour Ansible
  config.ssh.insert_key = false

  # =========================================================================
  # MANAGER NODE
  # =========================================================================
  config.vm.define "manager" do |m|
    m.vm.hostname = "manager"
    m.vm.network "private_network", ip: MANAGER_IP
  end

  # =========================================================================
  # WORKER 1
  # =========================================================================
  config.vm.define "worker1" do |w|
    w.vm.hostname = "worker1"
    w.vm.network "private_network", ip: WORKER1_IP
  end

  # =========================================================================
  # WORKER 2
  # =========================================================================
  config.vm.define "worker2" do |w|
    w.vm.hostname = "worker2"
    w.vm.network "private_network", ip: WORKER2_IP
  end
end
